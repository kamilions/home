<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Calculate the class activity grades of the ILI students.">
  <title>Class Activity Calculator</title>
  <link rel="icon" href="favicon.ico">
  <link rel="stylesheet" href="style.css">
</head>

<body>
  <!-- Preloader -->
  <div id="preloader">
    <div class="spinner"></div>
    <p>Загрузка...</p>
  </div>
  
  <!-- Фиксированное меню с логотипом и навигацией -->
  <header>
    <div class="header-top">
      <img src="logo.png" alt="Logo">
      <h1>Class Activity Calculator</h1>
    </div>
    <nav>
      <ul>
        <li><a href="#calculator" id="current">Children</a></li>
        <li><a href="teenagers.html">Teenagers</a></li>
        <li id="dropdown">
          <a href="#" class="dropdown-title">Adults</a>
          <ul>
            <li><a href="adults-elementary.html">Elementary</a></li>
            <li><a href="adults-other.html">Other</a></li>
          </ul>
        </li>
      </ul>
    </nav>
  </header>
  
  <!-- Hero Section с анимированным градиентом и частицами -->
  <section id="hero">
    <canvas id="particle-canvas"></canvas>
    <div class="hero-content">
      <h1>Добро пожаловать в Class Activity Calculator!</h1>
      <p>Посчитайте оценки активности учеников быстро и легко.</p>
      <button id="scrollToCalculator">Перейти к калькулятору</button>
    </div>
  </section>
  
  <!-- Секция калькулятора -->
  <section id="calculator">
    <h2>Children</h2>
    <form autocomplete="off">
      <fieldset data-weight="1">
        <legend>Listening</legend>
        <input type="number" step="any" min="0" max="60">
        <input type="number" step="any" min="0" max="60">
        <input type="number" step="any" min="0" max="60">
        <input type="number" step="any" min="0" max="60">
        <output></output>
      </fieldset>
      <fieldset data-weight="1">
        <legend>Speaking</legend>
        <input type="number" step="any" min="0" max="60">
        <input type="number" step="any" min="0" max="60">
        <input type="number" step="any" min="0" max="60">
        <input type="number" step="any" min="0" max="60">
        <output></output>
      </fieldset>
      <fieldset data-weight="1">
        <legend>Reading</legend>
        <input type="number" step="any" min="0" max="60">
        <input type="number" step="any" min="0" max="60">
        <input type="number" step="any" min="0" max="60">
        <input type="number" step="any" min="0" max="60">
        <output></output>
      </fieldset>
      <fieldset data-weight="1">
        <legend>Writing</legend>
        <input type="number" step="any" min="0" max="60">
        <input type="number" step="any" min="0" max="60">
        <input type="number" step="any" min="0" max="60">
        <input type="number" step="any" min="0" max="60">
        <output></output>
      </fieldset>
      <fieldset data-weight="1">
        <legend>Behavior</legend>
        <input type="number" step="any" min="0" max="60">
        <input type="number" step="any" min="0" max="60">
        <output></output>
      </fieldset>
      <fieldset data-weight="1">
        <legend>Homework</legend>
        <input type="number" step="any" min="0" max="60">
        <input type="number" step="any" min="0" max="60">
        <output></output>
      </fieldset>
      <div>
        <button type="button">Calculate</button>
        <output class="final-output"></output>
        <button type="reset">Reset</button>
      </div>
    </form>
  </section>
  
  <!-- Footer -->
  <footer id="footer">
    <p>&copy; 2025 Class Activity Calculator. Все права защищены.</p>
    <div class="social">
      Share on 
      <a href="https://t.me/share/url?url=https%3A%2F%2Fclassactivitycalculator.github.io" target="_blank" title="Telegram">Telegram</a> |
      <a href="https://www.facebook.com/sharer.php?u=https%3A%2F%2Fclassactivitycalculator.github.io" target="_blank" title="Facebook">Facebook</a>
    </div>
    <address>Created by <a href="https://mori.pages.dev" title="Mori" rel="author">Mori</a></address>
  </footer>
  
  <!-- Кнопка возврата наверх -->
  <button id="scrollToTop">&#8679;</button>
  
  <script>
    document.addEventListener("DOMContentLoaded", function() {
      /* Прелоадер: исчезает после загрузки страницы */
      window.addEventListener("load", function() {
        const preloader = document.getElementById("preloader");
        preloader.style.transition = "opacity 0.5s ease-out";
        preloader.style.opacity = "0";
        setTimeout(function() {
          preloader.style.display = "none";
        }, 500);
      });
      
      /* Плавная прокрутка для навигационных ссылок (если ссылка-якорь) */
      document.querySelectorAll("nav ul li a").forEach(link => {
        link.addEventListener("click", function(e) {
          if(this.getAttribute("href").startsWith("#")){
            e.preventDefault();
            const targetId = this.getAttribute("href").substring(1);
            const targetSection = document.getElementById(targetId);
            if (targetSection) {
              targetSection.scrollIntoView({ behavior: "smooth" });
            }
          }
        });
      });
      
      /* Плавная прокрутка для кнопки "Перейти к калькулятору" */
      document.getElementById("scrollToCalculator").addEventListener("click", function() {
        document.getElementById("calculator").scrollIntoView({ behavior: "smooth" });
      });
      
      /* Параллакс-эффект для контента в hero */
      window.addEventListener("scroll", () => {
        const heroContent = document.querySelector(".hero-content");
        let scrolled = window.pageYOffset;
        if(heroContent) {
          heroContent.style.transform = "translateY(" + (scrolled * 0.5) + "px)";
        }
        const scrollBtn = document.getElementById("scrollToTop");
        if (window.pageYOffset > 300) {
          scrollBtn.classList.add("active");
        } else {
          scrollBtn.classList.remove("active");
        }
      });
      
      /* Частицы в canvas */
      const canvas = document.getElementById("particle-canvas");
      const ctx = canvas.getContext("2d");
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
      
      let particles = [];
      const particleCount = 100;
      
      function Particle(x, y, dx, dy, size, color) {
        this.x = x;
        this.y = y;
        this.dx = dx;
        this.dy = dy;
        this.size = size;
        this.color = color;
      }
      Particle.prototype.draw = function() {
        ctx.beginPath();
        ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2, false);
        ctx.fillStyle = this.color;
        ctx.fill();
      };
      Particle.prototype.update = function() {
        if (this.x + this.size > canvas.width || this.x - this.size < 0) {
          this.dx = -this.dx;
        }
        if (this.y + this.size > canvas.height || this.y - this.size < 0) {
          this.dy = -this.dy;
        }
        this.x += this.dx;
        this.y += this.dy;
        this.draw();
      };
      
      function initParticles() {
        particles = [];
        for (let i = 0; i < particleCount; i++) {
          let size = Math.random() * 3 + 1;
          let x = Math.random() * (canvas.width - size * 2) + size;
          let y = Math.random() * (canvas.height - size * 2) + size;
          let dx = (Math.random() - 0.5) * 2;
          let dy = (Math.random() - 0.5) * 2;
          let color = "rgba(255,255,255,0.8)";
          particles.push(new Particle(x, y, dx, dy, size, color));
        }
      }
      function animateParticles() {
        requestAnimationFrame(animateParticles);
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        particles.forEach(particle => particle.update());
      }
      initParticles();
      animateParticles();
      window.addEventListener("resize", function() {
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;
        initParticles();
      });
      
      /* Логика калькулятора */
      const form = document.querySelector("form");
      
      function averageInputValues(fieldset) {
        let totalValue = 0;
        let count = 0;
        const inputs = fieldset.querySelectorAll("input");
        for (let input of inputs) {
          if (!input.validity.valid || input.value === "") {
            return;
          }
          totalValue += Number(input.value);
          count++;
        }
        return totalValue / count;
      }
      
      function setOutputValues() {
        const max = form.querySelector("input").max;
        let totalWeightedAverage = 0;
        let totalWeight = 0;
        const fieldsets = form.querySelectorAll("fieldset");
        for (let fieldset of fieldsets) {
          const average = averageInputValues(fieldset);
          const fieldsetOutput = fieldset.querySelector("output");
          if (average === undefined) {
            fieldsetOutput.value = "Enter grade between 0 and " + max;
          } else if (isNaN(average)) {
            fieldsetOutput.value = "Please enter a grade.";
          } else {
            fieldsetOutput.value = "avg: " + average.toFixed(1);
          }
          let weight = fieldset.dataset.weight;
          if (!weight) { weight = 1; }
          totalWeightedAverage += (average || 0) * weight;
          totalWeight += Number(weight);
        }
        const classActivity = totalWeightedAverage / totalWeight;
        const outputFinal = form.querySelector(".final-output");
        if (isNaN(classActivity)) {
          outputFinal.value = "";
        } else {
          outputFinal.value = "CA: " + classActivity.toFixed(1);
        }
      }
      
      form.querySelector('[type="button"]').addEventListener("click", setOutputValues);
      
      function detectChange() {
        const inputs = form.querySelectorAll("input");
        for (let input of inputs) {
          if (input.value) return true;
        }
      }
      form.addEventListener("reset", function(event) {
        if (detectChange() && !confirm("Your changes will be lost.\nAre you sure you want to reset?")) {
          event.preventDefault();
        }
      });
      window.addEventListener("beforeunload", function(event) {
        if (detectChange()) {
          event.returnValue = "Your changes may be lost.";
        }
      });
      
      /* Кнопка возврата наверх */
      document.getElementById("scrollToTop").addEventListener("click", function() {
        window.scrollTo({ top: 0, behavior: "smooth" });
      });
    });
  </script>
</body>
</html>
  <script src="script.js" defer></script>
</body>
</html>
